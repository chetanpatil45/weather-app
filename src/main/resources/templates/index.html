<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Glass App</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: linear-gradient(135deg, #667eea, #764ba2);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', sans-serif;
        }

        .glass-card {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 40px;
            width: 900px;
            color: white;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .forecast-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            margin-top: 20px;
        }

        .forecast-card {
            min-width: 120px;
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }

        .forecast-card:hover {
            transform: translateY(-5px);
        }

        .spinner {
            display: none;
        }
    </style>
</head>
<body>

<div class="glass-card text-center">

    <h2 class="mb-4">ðŸŒ¤ Weekly Weather Forecast</h2>

    <div class="input-group mb-3">
        <input type="text" id="cityInput" class="form-control"
               placeholder="Enter city">
        <button class="btn btn-light" onclick="getWeather()">Search</button>
    </div>

    <!-- Spinner -->
    <div class="spinner" id="loadingSpinner">
        <div class="spinner-border text-light" role="status"></div>
        <p>Loading weather data...</p>
    </div>

    <!-- Current Weather -->
    <div id="currentWeather" style="display:none;">
        <h3 id="cityName"></h3>
        <h1 id="temperature"></h1>
        <p id="description"></p>
    </div>

    <!-- 7 Day Forecast -->
    <div class="forecast-container" id="forecastSection"></div>

</div>

<script>
    function getWeather() {
        const city = document.getElementById("cityInput").value;
        if (!city) return;

        document.getElementById("loadingSpinner").style.display = "block";
        document.getElementById("currentWeather").style.display = "none";
        document.getElementById("forecastSection").innerHTML = "";

        fetch("/weather/forecast/" + city) // You create this endpoint
            .then(response => response.json())
            .then(data => {
                document.getElementById("loadingSpinner").style.display = "none";
                document.getElementById("currentWeather").style.display = "block";

                document.getElementById("cityName").innerText = data.city.name;
                document.getElementById("temperature").innerText =
                    Math.round(data.list[0].main.temp) + "Â°C";
                document.getElementById("description").innerText =
                    data.list[0].weather[0].description;

                const forecastContainer = document.getElementById("forecastSection");

                // Filter entries at 12:00:00
                const dailyData = data.list.filter(item =>
                    item.dt_txt.includes("12:00:00")
                );

                dailyData.forEach(day => {
                    const card = document.createElement("div");
                    card.className = "forecast-card";

                    const date = new Date(day.dt * 1000);
                    const dayName = date.toLocaleDateString("en-US", { weekday: 'short' });

                    card.innerHTML = `
                        <h6>${dayName}</h6>
                        <img src="https://openweathermap.org/img/wn/${day.weather[0].icon}.png"/>
                        <p>${Math.round(day.main.temp)}Â°C</p>
                    `;

                    forecastContainer.appendChild(card);
                });
            })
            .catch(() => {
                document.getElementById("loadingSpinner").style.display = "none";
                alert("City not found!");
            });
    }
</script>

</body>
</html>
